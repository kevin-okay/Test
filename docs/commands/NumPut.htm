<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>NumPut</title>
<meta http-equiv="content-type" content="text/html; charset=GB2312">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/jquery.js" type="text/javascript"></script>
<script src="../static/tree.jquery.js" type="text/javascript"></script>
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>NumPut</h1>
<p>以二进制格式把数字存储到指定地址+偏移的位置。</p>
<pre class="Syntax">NumPut(Number, VarOrAddress [, Offset = 0][, Type = "UPtr"])</pre>

<h3>参数</h3>
<dl>

  <dt>数字</dt>
  <dd><p>要保存的数字。</p></dd>

  <dt>VarOrAddress</dt>
  <dd><p>内存地址或变量。如果 <em>VarOrAddress</em> 是类似 <code>MyVar</code> 的变量且它的值不是纯数字或对象，则相当于传递 <code>&amp;MyVar</code>。然而，省略“&amp;”可以执行的更好并确保目标地址+偏移是<a href="VarSetCapacity.htm">有效的</a>。</p></dd>

  <dt>Offset</dt>
  <dd><p>偏移（单位为字节），添加到 <em>VarOrAddress</em> 以确定目标地址。</p></dd>

  <dt>类型</dt>
  <dd>
    <p>下列字符串的其中一个（省略时默认为 UPtr）：<br>UInt、Int、Int64、Short、UShort、Char、UChar、Double、Float、Ptr 或 UPtr</p>
    <p>与 DllCall 不同的是，作为原义字符串使用时必须括在引号中。</p>
    <p>更多细节请参阅 <a href="DllCall.htm#types">DllCall 类型</a>。</p>
  </dd>

</dl>

<h3>返回值</h3>
<p>如果目标地址无效，则返回空字符串。然而，某些无效地址这里无法检测出来并可能导致不可预知的行为。</p>
<p>其他情况下则返回刚写入项右边的地址。常用于写入不同类型的一序列数字，例如在 DllCall 中使用的结构。</p>

<h3>一般说明</h3>
<p>如果整数太大而无法用指定的 <em>Type</em> 存储，那么它的高位会被忽略：例如 <code>NumPut(257, var, 0, "Char")</code> 将存储数字 1。</p>
<p>如果只使用了三个参数，则第三个参数可以为 <em>Offset</em> 或 <em>Type</em>。例如，<code>NumPut(x, var, "int")</code> 是有效的。</p>

<h3>相关</h3>
<p><a href="NumGet.htm">NumGet</a>, <a href="DllCall.htm">DllCall</a>, <a href="VarSetCapacity.htm">VarSetCapacity</a></p>


</body>
</html>
