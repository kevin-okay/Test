<!DOCTYPE HTML>
<html>
<head>
<title>CoordMode</title>
<meta http-equiv="content-type" content="text/html; charset=GB2312">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>CoordMode</h1>

<p>为多个命令设置坐标模式,相对于活动窗口还是屏幕.</p>

<pre class="Syntax">CoordMode, ToolTip|Pixel|Mouse|Caret|Menu [, Window|Screen|Client]</pre>
<h3>参数</h3>
<dl>

  <dt>Param1</dt>
  <dd><p><strong>ToolTip</strong>: 作用于 <a href="ToolTip.htm">ToolTip</a>.</p>
    <p><strong>Pixel</strong>: 作用于 <a href="PixelGetColor.htm">PixelGetColor</a>, <a href="PixelSearch.htm">PixelSearch</a> 和 <a href="ImageSearch.htm">ImageSearch</a>.</p>
    <p><strong>Mouse</strong>: 作用于 <a href="MouseGetPos.htm">MouseGetPos</a>, <a href="Click.htm">Click</a> 以及 <a href="MouseMove.htm">MouseMove</a>/<a href="MouseClick.htm">Click</a>/<a href="MouseClickDrag.htm">Drag</a>.</p>
    <p><strong>Caret</strong>: 作用于内置变量 <a href="../Variables.htm#Caret">A_CaretX</a> 和 <a href="../Variables.htm#Caret">A_CaretY</a>.</p>
    <p><strong>Menu</strong>: 作用于为 <a href="Menu.htm#Show">Menu Show</a> 命令指定坐标的时候.</p></dd>

  <dt>Param2</dt>
  <dd><p>如果省略 <em>Param2</em>, 则默认为 Window.(译者注: 以前的文档都是说 Screen 是默认值, 但经过实测, Window 才是默认值.)</p>
      <p><strong>Screen</strong>: 表示坐标范围是整个屏幕. <br>译者注: 多屏幕的情况下以所有可用屏幕相加的值为坐标系,而不是各自独立计算.</p>
      <p><strong>Relative</strong>: 表示坐标范围是当前活动窗口.</p>
      <p><strong>Window</strong> <span class="ver">[v1.1.05+]</span>: 等同于 <em>Relative</em>, 且含义更清晰, 建议使用. (译者注: 这也是所有 <a href="../Variables.htm#CoordMode">A_CoordMode 变量</a>的默认值)</p>
      <p><strong>Client</strong> <span class="ver">[v1.1.05+]</span>:坐标相对于活动窗口的<b>工作区</b>,不包括标题栏,菜单栏和边框. Client 坐标模式较少依赖于操作系统版本和主题.</p><p>译者注: 推荐使用 Windows 或 Screen 即可. <br>Client 特别不推荐使用, 因为它在不同系统,不同主题下计算方法不同.<br>如果希望跨系统使用精确的鼠标点击或者取色之类的操作,建议使用 Windows,同时手动保证: 操作系统一致,主题一致即可.</p>
      </dd>

</dl>

<h3>备注</h3>
<p>默认值为相对于活动窗口的坐标模式 (译者注: 即 Window 或 Relative).</p>
<p><span class="ver">[v1.1.23+]:</span> 可随时用内置全局变量 <a href="../Variables.htm#CoordMode">A_CoordMode...</a> 检查当前所使用的坐标系.</p>
<p>如果在脚本的自动执行段使用本命令, 将改变全局坐标系的默认设置. 之后的每个新 <a href="../misc/Threads.htm">线程</a> (例如 <a href="../Hotkeys.htm">热键</a>, <a href="Menu.htm">自定义菜单项</a> 和 <a href="SetTimer.htm">定时</a> 子程序) 都会以此默认设置为准.</p>
<p>当然,也可以在这些新线程中再次使用本命令定义指定坐标系,从而避免使用全局设置的坐标系.但要注意的是,当线程退出时,最好再次执行一次本命令来还原全局坐标系设置,否则可能造成意外.因为您可能不太清楚当前代码是否会影响全局坐标系设置.</p>
<p>译者注: 建议一个脚本仅使用一种坐标系,而不要临时更改. 一般保持默认值即可适应大多数情况(即无需手动执行本命令).</p>

<h3>相关</h3>
<p><a href="Click.htm">Click</a>, <a href="MouseMove.htm">MouseMove</a>, <a href="MouseClick.htm">MouseClick</a>, <a href="MouseClickDrag.htm">MouseClickDrag</a>, <a href="MouseGetPos.htm">MouseGetPos</a>, <a href="PixelGetColor.htm">PixelGetColor</a>, <a href="PixelSearch.htm">PixelSearch</a>, <a href="ToolTip.htm">ToolTip</a>, <a href="Menu.htm">Menu</a></p>
<h3>示例</h3>
<pre class="NoIndent">
CoordMode, ToolTip, Screen  <em>; 设置 ToolTips 使用整个屏幕作为坐标系</em>
</pre>

</body>
</html>
