<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>AutoHotkey FAQ</title>
<link href="static/theme.css" rel="stylesheet" type="text/css" />
<script src="static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>常见问题(FAQ)</h1>

<p>如果您的问题没有在后面列出,请查看社区维护的页面 <a href="http://www.autohotkey.net/~faqbot/faq.html">FAQ on autoHotkey.net</a>.</p>

<h3>语言语法</h3>
<ul>
  <li><a href="#quotes">什么时候需要在命令和它们的参数中使用引号?</a></li>
  <li><a href="#percent">什么时候需要将变量名括在百分号中?</a></li>
  <li><a href="#esc">什么时候应该对百分号和逗号进行转义?</a></li>
</ul>
<h3>常见任务</h3>
<ul>
  <li><a href="#autoexec">为什么我脚本中的某些行总是无法执行?</a></li>
  <li><a href="#vista">为什么我的脚本在 XP 运行良好却无法工作于 Windows <em>xxx</em> ?</a></li>
  <li><a href="#uac">我该如何处理用 户账户控制 (UAC) 导致的问题?</a></li>
  <li><a href="#DefaultScript">我想通过托盘图标编辑脚本,但它只显示一个错误. 能在其他位置找到我的脚本吗?</a></li>
  <li><a href="#Debug">如何查找代码中的错误并修改呢?</a></li>
  <li><a href="#run">为什么 Run 命令不能启动我的游戏或程序?</a></li>
  <li><a href="#games">为什么在某些游戏中热字串, Send 和 MouseClick 不起作用?</a></li>
  <li><a href="#perf">如何在玩游戏或平时 CPU 高负荷运行时改善性能?</a></li>
  <li><a href="#Virus">我的杀毒软件把 AHK 归为恶意软件. 它真的含病毒吗?</a></li>
</ul>
<h3>Common Tasks</h3>
<ul>
  <li><a href="#Download">我可以在哪里找到官方构建或更旧的版本?</a></li>
  <li><a href="#USB">可以在 USB 驱动器中运行 AHK 代码吗?</a></li>
  <li><a href="#output">如何获取命令行操作的输出?</a></li>
  <li><a href="#close">如何让一个脚本关闭, 暂停或挂起其他的脚本?</a></li>
  <li><a href="#repeat">如何在不退出脚本的情况下停止重复的动作?</a></li>
  <li><a href="#help">如何在任意编辑器中使用上下文相关的 AutoHotkey 命令帮助?</a></li>
  <li><a href="#load">如何检测一个网页何时加载完毕?</a></li>
  <li><a href="#time">如何比较或操作日期与时间?</a></li>
  <li><a href="#SendDate">如何发送当前的日期和时间?</a></li>
  <li><a href="#ControlSend">如何发送文本到不活跃或隐藏的窗口?</a></li>
  <li><a href="#winamp">如何控制 Winamp, 即使在它未激活时?</a></li>
  <li><a href="#msgbox">如何改变 MsgBox 的按钮名称?</a></li>
  <li><a href="#DefaultEditor">如何改变默认编辑器,即通过上下文菜单或托盘图标打开的那个?</a></li>
  <li><a href="#GuiSubmit">如何保存 GUI 关联变量的内容?</a></li>
  <li><a href="#GDIPlus">如何用 AHK 描绘?</a></li>
  <li><a href="#WinWaitAction">如何在窗口出现,关闭或变成(不)活跃时执行操作?</a></li>
</ul>
<h3>热键, 热字串和重映射</h3>
<ul>
  <li><a href="#Startup">如何让我的热键和热字串在 PC 启动时自动生效?</a></li>
  <li><a href="#HotMouse">我在把鼠标按钮作为热键使用时遇到问题. 能提供一些建议吗?</a></li>
  <li><a href="#HotSymb">如何将 tab 和空格设置为热键?</a></li>
  <li><a href="#Remap">如何将按键或鼠标按钮重映射成其他键?</a></li>
  <li><a href="#DoublePress">如何检测按键或按钮的双击?</a></li>
  <li><a href="#HotContext">如何让热键或热字串只在特定的程序中有效? 换句话说, 在特定的窗口不活动时我想让特定的按键执行它原来的功能.</a></li>
  <li><a href="#HotPrefix">如何让前缀按键执行它原来的功能, 而不是什么都不做?</a></li>
  <li><a href="#HotOverride">如何改变或禁用 Windows 内置的快捷键, 例如 Win+U (辅助工具管理器) 和 Win+R (运行)?</a></li>
  <li><a href="#HotRegEx">如何在热字串中使用通配符或正则表达式?</a></li>
  <li><a href="#SpecialKey">如何使用不存在于我键盘布局中的热键?</a></li>
  <li><a href="#HotZero">我的小键盘上有个特殊的 000 键. 可以把它设成热键吗?</a></li>
</ul>

<h2>语言语法</h2>
<h3 id="quotes">什么时候需要在命令和它们的参数中使用引号?</h3>
<p>双引号 (") 仅在 <a href="Variables.htm#Expressions">表达式</a> 中具有特殊的含义. 在其他的所有地方, 它们像普通字符一样被原义对待. 不过,当脚本启动程序或文档时,操作系统通常要求要用引号把含空格的命令行参数括起来,例如:<code>Run, Notepad.exe "C:\My Documents\Address List.txt"</code>. </p>
<h3 id="percent">什么时候需要将变量名括在百分号中?</h3>
<p>除了下面用 <strong>粗体</strong> 表示的情况外, 变量名总是要括在百分号中:</p>
<p>1) 在参数中的输入或输出变量: <code><a href="commands/StringLen.htm">StringLen</a>, <strong>OutputVar</strong>, <strong>InputVar</strong></code><br>
  2) 在赋值表达式的左侧: <code><strong>Var</strong> = 123abc</code><br>
  3) 在 <a href="commands/IfEqual.htm">传统 (非表达式) if 语句</a> 的左侧: <code>If <strong>Var1</strong> &lt; %Var2%</code><br>
4) 在<a href="Variables.htm#Expressions">表达式</a> 中的任意位置. 例如:</p>
<pre>If (<strong>Var1</strong> &lt;&gt; <strong>Var2</strong>)
    <strong>Var1 <a href="commands/SetExpression.htm">:=</a> Var2</strong> + 100</pre>
<h3 id="esc">什么时候应该对百分号和逗号进行 <a href="commands/_EscapeChar.htm">转义</a>?</h3>
<p>原义的百分号必须在它们前面加重音符/反引号进行 <a href="commands/_EscapeChar.htm">转义</a>. 例如: <code>MsgBox The current percentage is 25`%.</code> 原义的逗号也必须进行转义 (<code>`,</code>), 除非在 <a href="commands/MsgBox.htm">MsgBox</a> 或任何命令的最后一个参数 (在这种情况下可以使用重音符但不是必须的) 使用时.</p>
<p> 在 <a href="Variables.htm#Expressions">表达式</a> 中逗号或百分号括在引号中时, 可以使用这样重音符但不是必须的. 例如:<code>Var := &quot;15%&quot;</code>. </p>

<h2>General Troubleshooting</h2>
<h3 id="autoexec">为什么我脚本中的某些行总是无法执行?</h3>
<p>任何想在脚本启动时立即执行的行都应该出现在脚本的顶部, 要在首个 <a href="Hotkeys.htm">热键</a>, <a href="Hotstrings.htm">热字串</a> 或 <a href="commands/Return.htm">Return</a> 之前. 更多细节请参阅<a href="Scripts.htm#auto">自动执行部分</a>. </p>
<p>还有, 含有多行执行语句的 <a href="Hotkeys.htm">热键</a> 必须把它的首行写在热键的 <em>下面</em> 而不能在同一行. 例如:</p>
<pre>#space::  <em>; Win+空格键</em>
Run Notepad
WinWaitActive Untitled - Notepad
WinMaximize
return</pre>
<h3 id="vista">为什么我的脚本在 Windows <em>xxx</em> 运行良好却无法工作于 Windows 7 或更高的版本?</h3>
<p>因为您已经换了操作系统,很可能某些影响脚本的东西也改变了. 例如,当您换了新电脑,那么它和旧电脑有些地方是不一样的. 如果您同时更新了 AutoHotkey 的版本,那么请看看新版本的<a href="AHKL_ChangeLog.htm">更新日志</a>和<a href="Compat.htm">兼容性提示</a>以找出新旧版本的区别. </p>
<ul>
  <li>I've upgraded my computer/Windows and now my script won't work.</li>
  <li>Hotkeys/hotstrings don't work when a program running as admin is active.</li>
  <li>Some windows refuse to be automated (e.g. Device Manager ignores Send).</li>
</ul>
<p>If you've switched operating systems, it is likely that something else has also changed and may be affecting your script. For instance, if you've got a new computer, it might have different drivers or other software installed. If you've also updated to a newer version of AutoHotkey, find out which version you had before and then check the <a href="AHKL_ChangeLog.htm">changelog</a> and <a href="Compat.htm">compatibility notes</a>.</p>
<p><a href="commands/SoundGet.htm">SoundGet</a>, <a href="commands/SoundSet.htm">SoundSet</a>, <a href="commands/SoundGetWaveVolume.htm">SoundGetWaveVolume</a> and <a href="commands/SoundSetWaveVolume.htm">SoundSetWaveVolume</a> behave differently on Vista and later than on earlier versions of Windows. In particular, device numbers are different and some components may be unavailable. Behaviour depends on the audio drivers, which are necessarily different to the ones used on XP. The <a href="commands/SoundSet.htm#Ex">soundcard analysis script</a> can be used to find the correct device numbers.</p>
<p>Also refer to the following question:</p>

<h3 id="uac">How do I work around problems caused by User Account Control (UAC)?</h3>
<p><a href="http://windows.microsoft.com/en-US/windows7/What-is-User-Account-Control">User Account Control (UAC)</a> is a common cause of problems, especially when moving from Windows XP/Vista/7 to Vista/7/8/10. Although it is present in Windows Vista and later, it is enabled by default on new systems or new installs, and it is more difficult to disable on Windows 8 and later.</p>
<p>By default, UAC protects "elevated" programs (that is, programs which are running as admin) from being automated by non-elevated programs, since that would allow them to bypass security restrictions. Hotkeys are also blocked, so for instance, a non-elevated program cannot spy on input intended for an elevated program.</p>
<p>UAC may also prevent <a href="commands/Send.htm#SendPlayDetail">SendPlay</a> and <a href="commands/BlockInput.htm">BlockInput</a> from working.</p>
<p>Common workarounds are as follows:</p>
<ul>
  <li>修改 AutoHotkey.exe 以启用与管理程序的交互. 这样会带来一些坏处. 更多信息请参阅 <a href="http://www.autohotkey.com/board/topic/70449-enable-interaction-with-administrative-programs/">http://www.autohotkey.com/board/topic/70449-enable-interaction-with-administrative-programs/</a></li>
  <li><a href="Variables.htm#IsAdmin">以管理员权限</a>运行脚本. 注意这样的脚本中运行的任何程序也具有管理员权限. </li>
  <li>关闭<a href="http://windows.microsoft.com/en-US/windows7/What-is-User-Account-Control">用户账户控制</a>(不推荐),在 Windows 8 或之后的版本您还必须禁用"以管理员核准模式运行所有管理员(Run all administrators in Admin Approval Mode)"安全设置(也不推荐). </li>
  <li>Disable UAC completely. This is not recommended, and is not feasible on Windows 8 or later.</li>
</ul>

<h3 id="DefaultScript">我想通过托盘图标编辑脚本,但它只显示一个错误. 能在其他位置找到我的脚本吗?</h3>
<p>您必须首先修复您脚本中的错误才能找回AHK的系统托盘图标.但是首先您必须找到您的脚本.</p>
<p>请在下面的文件夹中寻找 AutoHotkey.ahk 文件:</p>
<ul>
  <li>您的 <em>Documents</em> (或 <em>My Documents</em>) 文件夹.</li>
  <li>安装 AutoHotkey 的文件夹,默认是 C:\Program Files\AutoHotkey. 如果您使用的不是安装版,那就去你在使用的 AutoHotkey.exe 的文件夹.</li>
</ul>
<p>如果您在其他目录中运行AutoHotkey, 脚本名称取决于 AutoHotkey 可执行文件的名称(不一定是 AutoHotkey.exe). 例如, 如果您运行的是 AutoHotkeyU32.exe, 那么请查找 AutoHotkeyU32.ahk. 注意,有可能您的系统配置为 ".ahk" 是隐藏文件, 但是文件一定有类似这样的图标 <img src="static/ahkfile16.png" alt="[H]"></p>
<p>您可以随时从右键菜单中选择 <em>Edit Script</em> 来编辑AHK脚本. 如果这个右键菜单命令无效, 您还可以用记事本或其他文本编辑器来编辑.</p>
<p>如果您是从开始菜单中运行 AutoHotkey 或是直接双击 AutoHotkey.exe 来运行 (不包含任何命令行参数), 那么它会查找上述的脚本来执行. 否则, 您可以在任意位置创建一个其他名称的AHK脚本文件 (something.ahk), 然后运行AHK脚本而不是 AutoHotkey.</p>
<p>另请参阅<a href="Scripts.htm#defaultfile">命令行参数"Script Filename"</a>和 <a href="Scripts.htm#port">AutoHotkey.exe 的可移植性</a>. </p>
<h3 id="Debug">如何查找代码中的错误并修改呢?</h3>
<p>对于简单的脚本,请参阅<a href="Scripts.htm#debug">调试脚本</a>. 要查看变量的内容,请使用 <a href="commands/MsgBox.htm">MsgBox</a> 或 <a href="commands/ToolTip.htm">ToolTip</a>. 对于复杂的脚本,请参阅<a href="Scripts.htm#idebug">交互式调试</a>. </p>
<h3 id="run">为什么 <a href="commands/Run.htm">Run</a> 命令不能启动我的游戏或程序?</h3>
<p>有些程序需要在它们自己的目录下运行 (不能确定时, 通常最好这样做). 例如:</p>
<pre>Run, %A_ProgramFiles%\Some Application\App.exe, %A_ProgramFiles%\Some Application</pre>
<p>If the program you are trying to start is in <code>%A_WinDir%\System32</code> and you are using AutoHotkey 32-bit on a 64-bit system, the <a href="https://msdn.microsoft.com/en-us/library/aa384187">File System Redirector</a> may be interfering. To work around this, use <code>%A_WinDir%\SysNative</code> instead; this is a virtual directory only visible to 32-bit programs running on 64-bit systems.</p>

<h3 id="games">为什么在某些游戏中 <a href="Hotstrings.htm">热字串</a>, <a href="commands/Send.htm">Send</a> 和 <a href="commands/Click.htm">Click</a> 不起作用?</h3>
<p>一些游戏禁止 AHK 发送键击和点击或获取像素颜色. </p>
<p>有一些替代方法,请试试下面提及的方案. 如果这些都无效,那么 AHK 可能不适用于您的游戏. 一些游戏含有防止反破解和作弊的措施,如 GameGuard 和 Hackshield. 如果是,则 AutoHotkey 很可能无法用于该游戏. </p>
<ul>
  <li>
  <p>通过 <a href="commands/Send.htm#SendPlay">SendPlay</a> 命令,<a href="commands/SendMode.htm">SendMode Play</a> 或 <a href="Hotstrings.htm">热字串选项 SP</a> 使用 SendPlay. </p>
  <pre>SendPlay, abc</pre>
  <pre>SendMode, Play
Send, abc</pre>
  <pre>:SP:btw::by the way

<em>; or</em>

#Hotstring SP
::btw::by the way</pre>
  <p>注: SendPlay 在启用了用户账户控制的 Windows Vista 或更高版本中可能没有效果,即使以管理员运行脚本. </p>
  </li>
  <li>
  <p>使用 <a href="commands/SetKeyDelay.htm">SetKeyDelay</a> 增加延迟. 例如:</p>
  <pre>SetKeyDelay, 0, 50
SetKeyDelay, 0, 50, Play</pre>
  </li>
  <li>
  <p>试试 <a href="commands/ControlSend.htm">ControlSend</a>,在其他 Send 模式无效时它可能行:</p>
  <pre>ControlSend,, abc, game_title</pre>
  </li>
  <li>
  <p>试试在多种发送方式中使用按键的按下和弹起事件: </p>
  <pre>Send {KEY down}{KEY up}</pre>
  </li>
  <li>
  <p>试试在按键的按下事件和弹起事件之间使用 <a href="commands/ControlSend.htm">Sleep</a>:</p>
  <pre>Send {KEY down}
Sleep 10 <em>; 试试不同的毫秒数</em>
Send {KEY Up}</pre>
  </li>
</ul>
<h3 id="perf">How can performance be improved for games or at other times when the CPU is under heavy load?</h3>
<p>If a script's <a href="Hotkeys.htm">Hotkeys</a>, <a href="commands/Click.htm">Clicks</a>, or <a href="commands/Send.htm">Sends</a> are noticeably slower than normal while the CPU is under heavy load, raising the script's process-priority may help. To do this, include the following line near the top of the script:</p>
<pre><a href="commands/Process.htm">Process</a>, Priority, , High</pre>
<h3 id="Virus">My antivirus program flagged AutoHotkey or a compiled script as malware. Is it really a virus?</h3>
<p>Although it is certainly possible that the file has been infected, most often these alerts are <em>false positives</em>, meaning that the antivirus program is mistaken. One common suggestion is to upload the file to an online service such as <a href="https://www.virustotal.com/">virustotal</a> or <a href="https://virusscan.jotti.org/">Jotti</a> and see what other antivirus programs have to say. If in doubt, you could send the file to the vendor of your antivirus software for confirmation. This might also help us and other AutoHotkey users, as the vendor may confirm it is a false positive and fix their product to play nice with AutoHotkey.</p>
<p>False positives might be more common for compiled scripts which have been compressed, such as with UPX (default for AutoHotkey 1.0 but not 1.1) or MPRESS (optional for AutoHotkey 1.1). As the default AutoHotkey installation does not include a compressor, compiled scripts are not compressed by default.</p>

<h2>Common Tasks</h2>

<h3 id="Download">Where can I find the official build, or older releases?</h3>
<p>See <a href="https://autohotkey.com/download/">download page of AutoHotkey</a>.</p>
<h3 id="USB">Can I run AHK from a USB drive?</h3>
<p>See <a href="Scripts.htm#port">Portability of AutoHotkey.exe</a>. Note that if you use auto-included function libraries, AutoHotkey.exe and the Lib folder must be up one level from Ahk2Exe.exe (e.g. \AutoHotkey.exe vs \Compiler\Ahk2Exe.exe). Also note that Ahk2Exe saves settings to the following registry key: <code>HKEY_CURRENT_USER\Software\AutoHotkey\Ahk2Exe</code>.</p>
<h3 id="output">How can the output of a command line operation be retrieved?</h3>
<p>Testing shows that due to file caching, a temporary file can be very fast for relatively small outputs. In fact, if the file is deleted immediately after use, it often does not actually get written to disk. For example:</p>
<pre><a href="commands/Run.htm">RunWait</a> %comspec% /c dir &gt; C:\My Temp File.txt
FileRead, VarToContainContents, C:\My Temp File.txt
FileDelete, C:\My Temp File.txt</pre>
<p>To avoid using a temporary file (especially if the output is large), consider using the <a href="commands/Run.htm#StdOut">Shell.Exec()</a> method as shown in the examples for the <a href="commands/Run.htm">Run</a> command.</p>
<h3 id="close">How can a script close, pause, or suspend other script(s)?</h3>
<p>First, here is an example that closes another script:</p>
<pre>DetectHiddenWindows On  <em>; Allows a script's hidden main window to be detected.</em>
SetTitleMatchMode 2  <em>; Avoids the need to specify the full path of the file below.</em>
WinClose Script's File Name.ahk - AutoHotkey  <em>; Update this to reflect the script's name (case sensitive).</em></pre>
<p>To <a href="commands/Suspend.htm">suspend</a> or <a href="commands/Pause.htm">pause</a> another script, replace the last line above with one of these:</p>
<pre>PostMessage, 0x111, 65305,,, Script's File Name.ahk - AutoHotkey  <em>; Suspend.</em>
PostMessage, 0x111, 65306,,, Script's File Name.ahk - AutoHotkey  <em>; Pause.</em></pre>
<h3 id="repeat">How can a repeating action be stopped without exiting the script?</h3>
<p>To pause or resume the entire script at the press of a key, assign a hotkey to the <a href="commands/Pause.htm">Pause</a> command as in this example:</p>
<pre>^!p::Pause  <em>; Press Ctrl+Alt+P to pause. Press it again to resume.</em></pre>
<p>To stop an action that is repeating inside a <a href="commands/Loop.htm">Loop</a>, consider the following working example, which is a hotkey that both starts and stops its own repeating action. In other words, pressing the hotkey once will start the Loop. Pressing the same hotkey again will stop it.</p>
<pre>#MaxThreadsPerHotkey 3
<strong>#z::  <em>; Win+Z hotkey (change this hotkey to suit your preferences).</em></strong>
#MaxThreadsPerHotkey 1
if KeepWinZRunning  <em>; This means an underlying <a href="misc/Threads.htm">thread</a> is already running the loop below.</em>
{
    KeepWinZRunning := false  <em>; Signal that thread's loop to stop.</em>
    return  <em>; End this thread so that the one underneath will resume and see the change made by the line above.</em>
}
<em>; Otherwise:</em>
KeepWinZRunning := true
Loop
{
    <strong><em>; The next four lines are the action you want to repeat (update them to suit your preferences):</em></strong>
    ToolTip, Press Win-Z again to stop this from flashing.
    Sleep 1000
    ToolTip
    Sleep 1000
    <strong><em>; But leave the rest below unchanged.</em></strong>
    if not KeepWinZRunning  <em>; The user signaled the loop to stop by pressing Win-Z again.</em>
        break  <em>; Break out of this loop.</em>
}
KeepWinZRunning := false  <em>; Reset in preparation for the next press of this hotkey.</em>
return</pre>
<h3 id="help">How can context sensitive help for AutoHotkey commands be used in any editor?</h3>
<p>Rajat created <a href="scripts/ContextSensitiveHelp.htm">this script</a>.</p>
<h3 id="load">How to detect when a web page is finished loading?</h3>
<p>With Internet Explorer, perhaps the most reliable method is to use DllCall and COM as demonstrated at <a href="http://www.autohotkey.com/forum/topic19256.html">www.autohotkey.com/forum/topic19256.html</a>. On a related note, the contents of the address bar and status bar can be retrieved as demonstrated at <a href="http://www.autohotkey.com/forum/topic19255.html">www.autohotkey.com/forum/topic19255.html</a>.</p>
<p><strong>Older, less reliable method:</strong> The technique in the following example will work with MS Internet Explorer for most pages. A similar technique might work in other browsers:</p>
<pre>Run, www.yahoo.com
MouseMove, 0, 0  <em>; Prevents the status bar from showing a mouse-hover link instead of &quot;Done&quot;.</em>
WinWait, Yahoo! - 
WinActivate 
<a href="commands/StatusBarWait.htm">StatusBarWait</a>, Done, 30
if ErrorLevel
   MsgBox The wait timed out or the window was closed. 
else 
   MsgBox The page is done loading.</pre>
<h3 id="time">How can dates and times be compared or manipulated?</h3>
<p>The <a href="commands/EnvAdd.htm">EnvAdd</a> command can add or subtract a quantity of days, hours, minutes, or seconds to a time-string that is in the <a href="commands/FileSetTime.htm#YYYYMMDD">YYYYMMDDHH24MISS</a> format. The following example subtracts 7 days from the specified time: <code>EnvAdd, VarContainingTimestamp, -7, days</code>.</p>
<p>To determine the amount of time between two dates or times, see <a href="commands/EnvSub.htm">EnvSub</a>, which gives an example. Also, the built-in variable <a href="Variables.htm#Now">A_Now</a> contains the current local time. Finally, there are several built-in <a href="Variables.htm#date">date/time variables</a>, as well as the <a href="commands/FormatTime.htm">FormatTime</a> command to create a custom date/time string.</p>
<h3 id="SendDate">How can I send the current Date and/or Time?</h3>
<p>Use <a href="commands/FormatTime.htm">FormatTime</a> or <a href="Variables.htm#date">built-in variables for date and time</a>.</p>
<h3 id="ControlSend">How can I send text to a window which isn't active or isn't visible?</h3>
<p>Use <a href="commands/ControlSend.htm">ControlSend</a>.</p>
<h3 id="winamp">如何控制 Winamp, 即使在它未激活时?</h3>
<p>请参阅 <a href="misc/Winamp.htm">让 Winamp 自动化</a>.</p>
<h3 id="msgbox">如何改变 <a href="commands/MsgBox.htm">MsgBox</a> 的按钮名称?</h3>
<p>这里有个 <a href="scripts/MsgBoxButtonNames.htm">例子</a>.</p>
<h3 id="DefaultEditor">如何改变默认编辑器,即通过上下文菜单或托盘图标打开的那个?</h3>
<p>在 <a href="commands/Edit.htm">Edit</a> 的示例部分可以找到能让您改变默认编辑器的脚本. </p>
<h3 id="GuiSubmit">如何保存 GUI 关联变量的内容?</h3>
<p>请使用 <a href="commands/Gui.htm#Submit">Gui Submit</a>. 例如:</p>
<pre>Gui, Add, Text,, Enter some Text and press Submit:
Gui, Add, Edit, vAssociatedVar
Gui, Add, Button,, Submit
Gui, Show
Return

ButtonSubmit:
Gui, Submit, NoHide
MsgBox, Content of the edit control: %AssociatedVar%
Return</pre>
<h3 id="GDIPlus">如何用 AHK 画点什么东西?</h3>
<p>请参阅 tic 写的 <a href="http://www.autohotkey.com/forum/topic32238.html">GDI+ standard library</a> . 它可以通过一些基本方法方法有限的使用 Gui. </p>
<h3 id="WinWaitAction">如何在窗口出现,关闭或变成(不)活跃时执行操作?</h3>
<p>使用 <a href="commands/WinWait.htm">WinWait</a>,<a href="commands/WinWaitClose.htm">WinWaitClose</a> 或 <a href="commands/WinWaitActive.htm">WinWait[Not]Active</a>. 请参阅<a href="http://www.autohotkey.net/~faqbot/faq.html#window">社区驱动的常见问题</a>(窗口部分)了解更多. </p>
<h2>热键, 热字串和重映射</h2>
<h3 id="Startup">如何让我的热键和热字串在 PC 启动时自动生效?</h3>
<p>在开始菜单中有一个 Startup "启动"文件夹.如果把脚本的快捷方式放到该文件夹,则对应的脚本会在每次启动电脑时自动运行.要创建快捷方式:</p>
<ol>
  <li>找到脚本文件后选中它, 接着按下 Control-C.</li>
  <li>右键点击开始按钮 (通常在屏幕的左下角) 并选择 &quot;浏览所有用户&quot;.</li>
  <li>定位到 Programs (程序)文件夹中的 Startup (启动)文件夹.</li>
  <li>在菜单栏中选择 <em>编辑 -&gt; 粘贴快捷方式</em> .现在启动文件夹中应该出现了该脚本的快捷方式.</li>
</ol>
<h3 id="HotMouse">我在把鼠标按钮作为热键使用时遇到问题. 能提供一些建议吗?</h3>
<p>鼠标左键和右键应该可以正常设置为热键(例如,<code>#LButton::</code> 为 Win+LeftButton 热键). 同样地,鼠标中键和<a href="KeyList.htm">鼠标滚轮</a>的转动应该可以正常地设置为热键,除非对于驱动直接控制这些按钮的鼠标. </p>
<p> 第四个按钮 (XButton1) 和第五个按钮 (XButton2) 也可以设置为热键, 如果您的鼠标驱动让系统可以 <a href="commands/KeyHistory.htm">看到</a> 这些按键的点击时. 如果它们不可见或您的鼠标除了您使用的五个按钮外还有更多的按钮, 您可以尝试配置鼠标附带的软件 (有时需要通过控制面板或开始菜单访问) 来实现当您按下其中的按钮时发送键击. 然后可以在脚本中把这样的键击设置为热键. 例如, 如果您配置第四个按钮来发送 Control+F1, 然后在脚本中通过使用 <code>^F1::</code> 您可以把这个按钮间接的设置为热键.</p>
<p>如果您有五键鼠标, 其中的第四和第五个按钮不 <a href="commands/KeyHistory.htm">可见</a>, 您可以尝试把鼠标驱动改变为 OS 自带的默认驱动. 这里假设您特殊的鼠标使用自己的驱动并且您不使用鼠标自带软件提供的功能.</p>
<h3 id="HotSymb">如何将 Tab 和空格设置为热键?</h3>
<p>使用它们的按键名称 (Tab 和 Space) 而不用它们的字符. 例如, <code>#Space</code> 为 Win+Space 而 <code>^!Tab</code> 为 Control+Alt+Tab.</p>
<h3 id="Remap">如何将按键或鼠标按钮重映射成其他键?</h3>
<p>解决的方法在 <a href="misc/Remap.htm">重映射</a> 页面说明了.</p>
<h3 id="DoublePress">如何检测按键或按钮的双击?</h3>
<p>像下面那样使用<a href="Variables.htm#h">可用于热键的内置变量</a>:</p>
<pre>~Ctrl::
    if (A_ThisHotkey = A_PriorHotkey &amp;&amp; A_TimeSincePriorHotkey &lt; 200)
        MsgBox double-press
return</pre>
<h3 id="HotContext">如何让 <a href="Hotkeys.htm">热键</a> 或 <a href="Hotstrings.htm">热字串</a> 只在特定的程序中有效? 换句话说, 在特定的窗口不活动时我想让特定的按键执行它原来的功能.</h3>
<p>首选的方法是使用 <a href="commands/_IfWinActive.htm">#IfWinActive</a>. 例如:</p>
<pre>#IfWinActive, ahk_class Notepad
^a::MsgBox You pressed Control-A while Notepad is active.
</pre>
<h3 id="HotPrefix">如何让前缀按键执行它原来的功能, 而不是什么都不做?</h3>
<p>请参考下面的例子, 其中把 Numpad0 作为前缀键:</p>
<pre>Numpad0 &amp; Numpad1::MsgBox, You pressed Numpad1 while holding down Numpad0.</pre>
<p>现在, 要让 Numpad0 在没有像上面那样用来触发热键时发送真正的 Numpad0 键击, 需要添加下面的热键:</p>
<pre> $Numpad0::Send, {Numpad0}</pre>
<p>使用前缀 $ 是为避免产生关于无效循环的警告对话框 (因为此热键 "发送了它自己"). 此外, 上述动作在 <strong>释放</strong> 此按键的时候发生.</p>
<h3 id="HotOverride">如何改变或禁用 Windows 内置的快捷键, 例如 Win+U (辅助工具管理器) 和 Win+R (运行)?</h3>
<p>这里有一些 <a href="misc/Override.htm">例子</a>.</p>
<h3 id="HotRegex">如何在热字串中使用通配符或正则表达式?</h3>
<p>使用 polyethene 写的<a href="https://github.com/polyethene/AutoHotkey-Scripts/blob/master/Hotstrings.ahk">脚本</a>(含示例). </p>
<h3 id="SpecialKey">如何使用不存在于我键盘布局中的热键?</h3>
<p>请参阅<a href="KeyList.htm#SpecialKeys">特殊按键</a>. </p>
<h3 id="HotZero">我的小键盘上有个特殊的 000 键. 可以把它设成热键吗?</h3>
<p>是的. 这个 <a href="scripts/Numpad000.htm">示例脚本</a> 把 000 键设成等号键. 您可以用您想要的语句替换 <code>Send, =</code> 来改变动作. </p>
</body>
</html>
